# Edge - CP03

[Back](../index.md)

- [Edge - CP03](#edge---cp03)
  - [POLICY LAYERS](#policy-layers)
    - [types of Policy layers](#types-of-policy-layers)
  - [Check Point NAT](#check-point-nat)
    - [Check Point NAT](#check-point-nat-1)
    - [Translation Methods](#translation-methods)
    - [Check Point NAT Rules](#check-point-nat-rules)
    - [Rule Enforcement](#rule-enforcement)
    - [Hide NAT](#hide-nat)
    - [Static NAT](#static-nat)
    - [Proxy ARP for Manual NAT](#proxy-arp-for-manual-nat)
  - [Security elevation](#security-elevation)

---

## POLICY LAYERS

- **Set of rules** or rulebase in a policy.
- Lets you separate Security Policy into smaller, more manageable components.
- A layer can contain the following Blades:
  - **Firewall** (Network Access Control)
  - Application & URL **Filtering**
  - **Content Awareness**
  - **Mobile** Access

---

- Benefits
  - Helps you **visually organize** the rulebase.
  - **Simplifies** Policy management by allowing delegation of ownership of different layers.
  - Improves **performance** by reducing the number of rules in a layer.

---

### types of Policy layers

- Ordered layer:

  - Flat rulebase.
  - Each layer is processed sequentially for a match.
  - If an **accept match** is found, it is processed by the **next layer** until a final decision is made.
  - Can contain **inline** layers.

- Inline layer:
  - inline layers organize the Access Control policy into a hierarchy.
  - **Sub-policy** that is independent of rest of rulebase.
  - Attached to specific rules.
  - If rule is **matched**, inspection **continues** in attached sub-policy.
  - If rule is **not** matched, the sub-policy is **bypassed**.

---

- To pass through the Gateway, the connection must **match an acceptable** rule on **all** ordered layers. 要通过，至少有一个层接受
- Any sub-rule will only affect traffic that matches the parent rule, not the entire Access Control rulebase.子规则只对通过父规则的流量。

---

Q&A

- What is the purpose of Policy layers?
  - Policy layers are **sets of rules** or a rulebase.
  - They let you **divide a policy**, such as the Access Control policy, into smaller, more manageable sections that serve a certain purpose. The layers concept also provides more options for policy management, including the ability to set different views and edit permissions per layer for different administrator roles.
- What type of Policy layer is independent of the rest of the rulebase?
  - Inline

---

## Check Point NAT

### Check Point NAT

- NAT is a method of **mapping** an **IP** address to another **IP** address.
- From IETF:
  - A method by which IP addresses are mapped from one realm to another in an attempt to **provide transparent routing** to hosts.

---

### Translation Methods

- **Static NAT**:
  - **One-to-one** relationship between **private** and **public** IP addresses.
  - Useful for servers or hosts that require a consistent address accessible from the Internet.
- **Hide NAT:**
  - **Many-to-one** translation that hides **many source** IP addresses **behind one** or a few IP addresses.
  - Useful when fewer IP addresses are available.

---

### Check Point NAT Rules

- Two types of NAT rules:
  - Automatic
  - Manual
- Part of the `NAT Policy`.
- Generally viewed and configured with SmartConsole.

---

- **Automatic NAT Rules**

  - In most cases, the NAT Policy is **automatically populated** with the necessary rules.
  - The Security **Gateway creates** the rules automatically, based on the defined network object proper.

- **Manual NAT Rules**

  - e.g.,
  - **Specified IP addresses** (destination and source) or services (ports)
  - Static NAT in **only one direction**
  - Translation of **source and destination** IP addresses in the same packet
  - Translation of services (destination **ports**)
  - Translation of IP addresses for **dynamic objects**

- When using **manual** NAT rules, `Proxy ARP` is required.

---

### Rule Enforcement

- **Manual** Rule Enforcement 第一个

  - With manual rule enforcement, the **first** manual NAT rule that **matches** a connection is **enforced**.
  - The Firewall does **not enforce a different** NAT rule that can be more applicable.

- **Automatic** Rule Enforcement 同时匹配

  - With automatic rule enforcement, two automatic NAT rules that match a connection can be enforced:
    - One rule for the **source**
    - One rule for the **destination**
  - When a connection **matches two** automatic rules, those rules are **enforced**.

- can enable automatic NAT rules for these SmartConsole objects:
  - Security Gateways
  - Hosts
  - Networks
  - Address Ranges

---

### Hide NAT

- configured by manually

- Two rules are created automatically.
  - The first rule **prevents** the translation of packets traveling from the translated object **to itself**.
  - The second rule instructs the Security Gateway to **translate** packets whose **source** IP address is part of the **company’s network**.
    - This rule translates packets from private addresses to the IP address of the exiting interface of the Security Gateway.
- Modify IP address information associated with traffic packets as they pass through Security Gateway.

---

### Static NAT

- **Assigned to a server** that needs to be accessed directly **from outside** the Security Gateway.

- creation of Static NAT rules adds two rules

---

### Proxy ARP for Manual NAT

---

Q&A

- List the two types of rules that Check Point NAT supports for address translation.
  - Automatic
  - Manual
  
- What is the difference between Hide NAT and Static NAT?
  - Hide NAT is a solution that only allows **outgoing** connections. 
    - It involves translating **many** `private addresses` to **one** `public address`. 
    - Hide NAT is most often used to allow internal users access to external resources.
  
  - Static NAT allows **both** incoming and outgoing connections. 
    - It involves the translation of **one** `private IP` address to **a** unique `public IP address` and from that unique public IP address to the private address. 

---

## Security elevation


